# 06-Orchestrated-Agent

A minimal orchestrator that reads one freeâ€‘form `instructions.md` and dispatches tasks to two child agents:

- **Smokeâ€‘Test Agent** â†’ writes `tests/smoke.auto.test.ts`
- **Mermaid Agent** â†’ writes `mermaid/mermaid.md` with a simple flow diagram of the app

No MCP; runs purely on npm + TypeScript + Vitest.

## TL;DR

```bash
cd 06-orchestrated-agent
npm install
npm run agent    # Orchestrator reads instructions.md and dispatches to sub-agents
npm test         # Run generated smoke tests
# Check mermaid/mermaid.md for the generated flow diagram
```

## Goals

âœ… Demonstrate a tiny orchestrator â†’ subâ€‘agents pattern  
âœ… Autoâ€‘create a green smoke test for src/  
âœ… Generate a Mermaid diagram (graph TD) describing modules/functions

## Project Structure

```
06-orchestrated-agent/
â”œâ”€ .gitignore               # ignores generated files (mermaid/, tests/smoke.auto.test.ts)
â”œâ”€ package.json
â”œâ”€ tsconfig.json
â”œâ”€ instructions.md          # freeform instructions (HE/EN)
â”œâ”€ README.md                # this file
â”œâ”€ src/
â”‚  â”œâ”€ index.ts             # auto generated sample file for Orchestrated Agent
â”‚  â””â”€ math.ts              # math utility functions
â”œâ”€ tests/                   # created/filled automatically
â”‚  â””â”€ smoke.auto.test.ts   # generated by smoke-agent.ts
â”œâ”€ mermaid/                 # created/filled automatically  
â”‚  â””â”€ mermaid.md           # generated by mermaid-agent.ts
â””â”€ agent/
   â”œâ”€ orchestrator.ts       # main agent (reads instructions, routes tasks)
   â”œâ”€ smoke-agent.ts        # creates tests/smoke.auto.test.ts
   â””â”€ mermaid-agent.ts      # creates mermaid/mermaid.md (Mermaid "graph TD")
```

## How it Works

1. **Orchestrator** (`agent/orchestrator.ts`) reads `instructions.md` and detects intents:
   - **SMOKE** â†’ run the Smokeâ€‘Test Agent
   - **FLOW** â†’ run the Mermaid Agent  
   - **SUMMARY** â†’ print a short summary

2. **Smokeâ€‘Test Agent** writes `tests/smoke.auto.test.ts` that verifies modules load and calls functions

3. **Mermaid Agent** scans `src/*.ts` for exported function names and produces `mermaid/mermaid.md` with a basic `graph TD` linking modules to their exported functions

## Intent Detection

Intents are detected via simple regex on the instruction text (supports English/Hebrew keywords):
- **Smoke tests**: "smoke tests", "×‘×“×™×§×•×ª ×¢×©×Ÿ", "create test", "generate test"
- **Flow diagrams**: "mermaid", "flow chart", "diagram", "×ª×¨×©×™×", "×–×¨×™××”"  
- **Summary**: "summary", "×¡×™×›×•×", "overview"

## Usage

```bash
# Install dependencies
npm install

# Run the orchestrator (reads instructions.md)
npm run agent

# Execute generated tests
npm test

# View the generated Mermaid diagram
# Open mermaid/mermaid.md in any Mermaid viewer or Mermaid Live Editor
```

## Example Output

The orchestrator will:
1. ğŸ­ Read and analyze `instructions.md`
2. ğŸ”¥ Dispatch to Smoke-Test Agent â†’ generates comprehensive tests
3. ğŸ“Š Dispatch to Mermaid Agent â†’ creates visual flow diagram
4. ğŸ“‹ Generate project summary if requested

All sub-agents report back to the orchestrator with their results!