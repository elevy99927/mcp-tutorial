# 07-Config-Driven-Agent

A config-driven orchestrator that reads `config/agents.json` to manage agent capabilities and policies, then dispatches tasks to specialized sub-agents:

- **Smokeâ€‘Test Agent** â†’ writes `tests/smoke.auto.test.ts`
- **Mermaid Agent** â†’ writes `mermaid/mermaid.md` with flow diagrams
- **README Agent** â†’ writes `README.auto.md` with comprehensive documentation

No MCP; runs purely on npm + TypeScript + Vitest with configuration-based agent management.

## TL;DR

```bash
cd 07-config-driven-agent
npm install
npm run agent    # Config-driven orchestrator reads config/agents.json and ./instructions.md
npm test         # Run generated smoke tests
# Check outputs/ directory for all generated content
```

## Goals

âœ… Demonstrate config-driven agent management with policies  
âœ… Add README generation agent for comprehensive documentation  
âœ… Validate agent capabilities against configuration  
âœ… Prepare foundation for MCP-style permissions

## Project Structure

```
07-config-driven-agent/
â”œâ”€ .gitignore               # ignores generated files
â”œâ”€ package.json
â”œâ”€ tsconfig.json
â”œâ”€ instructions.md          # freeform instructions (HE/EN)
â”œâ”€ README.md                # this file
â”œâ”€ config/
â”‚  â””â”€ agents.json          # agent configuration and policies
â”œâ”€ src/
â”‚  â”œâ”€ index.ts             # auto generated sample file
â”‚  â””â”€ math.ts              # math utility functions
â”œâ”€ outputs/                 # all generated content
â”‚  â”œâ”€ tests/
â”‚  â”‚  â””â”€ smoke.auto.test.ts   # generated by smoke-agent.ts
â”‚  â”œâ”€ mermaid/
â”‚  â”‚  â””â”€ mermaid.md          # generated by mermaid-agent.ts
â”‚  â””â”€ README.auto.md         # generated by readme-agent.ts
â””â”€ agent/
   â”œâ”€ orchestrator.ts       # config-driven orchestrator
   â”œâ”€ smoke-agent.ts        # creates tests/smoke.auto.test.ts
   â”œâ”€ mermaid-agent.ts      # creates mermaid/mermaid.md
   â””â”€ readme-agent.ts       # creates README.auto.md
```

## Agent Configuration

The `config/agents.json` file defines:

### Agent Capabilities
- **smoke-test-agent**: `["tests", "smoke"]`
- **mermaid-agent**: `["docs", "diagram", "mermaid", "flow"]`  
- **readme-agent**: `["docs", "readme", "documentation"]`

### Security Policies
Each agent has restricted permissions:
- **network**: `false` (no network access)
- **shell**: `false` (no shell commands)
- **fs**: `"restricted"` (limited file system access)
- **writePaths**: Allowed write locations
- **denyPaths**: Forbidden directories

## How it Works

1. **Orchestrator** loads `config/agents.json` and validates agent capabilities
2. **Instructions** are parsed from `instructions.md` for task detection
3. **Validation** ensures requested tasks match agent capabilities
4. **Dispatch** sends tasks to appropriate specialized agents
5. **Agents** operate within their configured security policies

## Intent Detection

Supports English/Hebrew keywords:
- **Smoke tests**: "smoke tests", "×‘×“×™×§×•×ª ×¢×©×Ÿ", "create test"
- **Flow diagrams**: "mermaid", "flow chart", "diagram", "×ª×¨×©×™×"  
- **Documentation**: "readme", "documentation", "docs", "×ª×™×¢×•×“"
- **Summary**: "summary", "×¡×™×›×•×", "overview"

## Usage

```bash
# Install dependencies
npm install

# Run the config-driven orchestrator
npm run agent

# Execute generated tests
npm test

# View generated content
cat outputs/README.auto.md           # Auto-generated documentation
cat outputs/mermaid/mermaid.md       # Visual flow diagrams
cat outputs/tests/smoke.auto.test.ts # Comprehensive test suite
```

## Key Improvements from Chapter 06

1. **ğŸ”§ Configuration Management**: Centralized agent config with capabilities and policies
2. **ğŸ“– README Agent**: Automatic documentation generation
3. **ğŸ”’ Security Policies**: File system restrictions and access controls
4. **âœ… Capability Validation**: Ensures agents can perform requested tasks
5. **ğŸ¯ MCP Preparation**: Foundation for Model Context Protocol integration

## Example Output

The orchestrator will:
1. ğŸ­ Load agent configurations from `config/agents.json`
2. âœ… Validate agent capabilities against requested tasks
3. ğŸ”¥ Dispatch to Smoke-Test Agent â†’ comprehensive tests
4. ğŸ“Š Dispatch to Mermaid Agent â†’ visual diagrams  
5. ğŸ“– Dispatch to README Agent â†’ project documentation
6. ğŸ“‹ Generate summary if requested

All agents operate within their configured security policies!